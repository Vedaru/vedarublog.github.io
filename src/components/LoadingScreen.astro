---
// 加载画面组件 - 在页面加载完成后自动隐藏
---

<div id="loading-screen" class="fixed inset-0 z-[9999] flex items-center justify-center bg-white dark:bg-neutral-950 transition-opacity duration-500">
	<!-- 加载动画容器 -->
	<div class="flex flex-col items-center gap-8">
		<!-- 旋转加载圆 -->
		<div class="relative w-16 h-16">
			<div class="absolute inset-0 rounded-full border-4 border-neutral-200 dark:border-neutral-800"></div>
			<div class="absolute inset-0 rounded-full border-4 border-transparent border-t-[var(--primary)] border-r-[var(--primary)] animate-spin"></div>
		</div>

		<!-- 加载文本 -->
		<div class="flex flex-col items-center gap-2">
			<p class="text-lg font-semibold text-neutral-900 dark:text-neutral-100">加载中...</p>
			<p class="text-sm text-neutral-500 dark:text-neutral-500">正在准备精彩内容</p>
		</div>

		<!-- 进度条 -->
		<div class="w-48 h-1 bg-neutral-200 dark:bg-neutral-800 rounded-full overflow-hidden">
			<div id="loading-progress" class="h-full bg-gradient-to-r from-[var(--primary)] to-[var(--secondary)] rounded-full w-1/3 transition-all duration-300"></div>
		</div>
	</div>
</div>

<style>
	@keyframes fadeOut {
		to {
			opacity: 0;
			visibility: hidden;
		}
	}

	#loading-screen.hide {
		animation: fadeOut 0.5s ease-out forwards;
	}
</style>

<script is:inline>
	// 防止 FOUC（Flash of Unstyled Content）
	document.documentElement.style.overflow = 'hidden';
	
	// 模拟加载进度
	const progressBar = document.getElementById('loading-progress');
	let progress = 30;

	const progressInterval = setInterval(() => {
		progress += Math.random() * 30;
		if (progress > 85) progress = 85;
		if (progressBar) {
			progressBar.style.width = progress + '%';
		}
	}, 300);

	// 监听页面加载完成
	window.addEventListener('load', () => {
		// 完成进度条
		if (progressBar) {
			progressBar.style.width = '100%';
		}
		clearInterval(progressInterval);

		// 延迟一下以确保所有资源都加载完成
		setTimeout(() => {
			const loadingScreen = document.getElementById('loading-screen');
			if (loadingScreen) {
				loadingScreen.classList.add('hide');
				// 动画完成后移除元素，释放 overflow hidden
				setTimeout(() => {
					loadingScreen.remove();
					document.documentElement.style.overflow = '';
				}, 500);
			}
		}, 200);
	});

	// 确保 DOM 交互性强时隐藏加载屏幕
	if (document.readyState === 'complete') {
		const loadingScreen = document.getElementById('loading-screen');
		if (loadingScreen) {
			loadingScreen.classList.add('hide');
			setTimeout(() => {
				loadingScreen.remove();
				document.documentElement.style.overflow = '';
			}, 500);
		}
	}
</script>
